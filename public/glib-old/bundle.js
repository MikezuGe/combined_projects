!function(t){var e={};function r(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=13)}([function(t,e,r){"use strict";var n=r(7),s=r(22),i=Object.prototype.toString;function o(t){return"[object Array]"===i.call(t)}function a(t){return null!==t&&"object"==typeof t}function u(t){return"[object Function]"===i.call(t)}function h(t,e){if(null!==t&&void 0!==t)if("object"!=typeof t&&(t=[t]),o(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(null,t[s],s,t)}t.exports={isArray:o,isArrayBuffer:function(t){return"[object ArrayBuffer]"===i.call(t)},isBuffer:s,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:a,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:u,isStream:function(t){return a(t)&&u(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:h,merge:function t(){var e={};function r(r,n){"object"==typeof e[n]&&"object"==typeof r?e[n]=t(e[n],r):e[n]=r}for(var n=0,s=arguments.length;n<s;n++)h(arguments[n],r);return e},extend:function(t,e,r){return h(e,function(e,s){t[s]=r&&"function"==typeof e?n(e,r):e}),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(43);Object.defineProperty(e,"Color",{enumerable:!0,get:function(){return c(n).default}});var s=r(44);Object.defineProperty(e,"Vec2",{enumerable:!0,get:function(){return c(s).default}});var i=r(45);Object.defineProperty(e,"Vec3",{enumerable:!0,get:function(){return c(i).default}});var o=r(46);Object.defineProperty(e,"Mat3",{enumerable:!0,get:function(){return c(o).default}});var a=r(47);Object.defineProperty(e,"Mat4",{enumerable:!0,get:function(){return c(a).default}});var u=r(48);Object.defineProperty(e,"Quat",{enumerable:!0,get:function(){return c(u).default}});var h=r(49);function c(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"Easing",{enumerable:!0,get:function(){return c(h).default}})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t){this.url=t}remove(){throw new Error(`Implement 'remove' function for resource: ${this.constructor.name}.`)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.canvas=void 0;var n=r(12);let s=document.getElementById("canvas");s||(e.canvas=s=document.createElement("canvas"),document.getElementById("root").appendChild(s));const i=s.getContext("webgl2");(s.resize=(()=>{s.width=window.innerWidth,s.height=window.innerHeight}))(),(i.resize=(()=>{i.viewport(0,0,window.innerWidth,window.innerHeight)}))(),n.windowResizeEvent.subscribe(s.resize,i.resize),e.canvas=s,e.default=i},function(t,e,r){"use strict";(function(e){var n=r(0),s=r(25),i={"Content-Type":"application/x-www-form-urlencoded"};function o(t,e){!n.isUndefined(t)&&n.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var a={adapter:function(){var t;return"undefined"!=typeof XMLHttpRequest?t=r(8):void 0!==e&&(t=r(8)),t}(),transformRequest:[function(t,e){return s(e,"Content-Type"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t)?t:n.isArrayBufferView(t)?t.buffer:n.isURLSearchParams(t)?(o(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):n.isObject(t)?(o(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],function(t){a.headers[t]={}}),n.forEach(["post","put","patch"],function(t){a.headers[t]=n.merge(i)}),t.exports=a}).call(this,r(24))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a(r(3)),s=r(1),i=a(r(2)),o=a(r(50));function a(t){return t&&t.__esModule?t:{default:t}}const u=t=>{const e=[];let r=0;return t.forEach(t=>{switch(t){case"a_position":e.push({name:"a_position",vertices:3,offset:r}),r+=3;break;case"a_texcoord":e.push({name:"a_texcoord",vertices:2,offset:r}),r+=2;break;case"a_normal":e.push({name:"a_normal",vertices:3,offset:r}),r+=3;break;case"a_tangent":e.push({name:"a_tangent",vertices:3,offset:r}),r+=3;break;case"a_bitangent":e.push({name:"a_bitangent",vertices:3,offset:r}),r+=3;break;default:throw new Error(`Unknown mesh attribute name: ${t}`)}}),e},h=t=>{let e=0;return t.forEach(t=>{switch(t){case"a_position":e+=3;break;case"a_texcoord":e+=2;break;case"a_normal":case"a_tangent":case"a_bitangent":e+=3;break;default:throw new Error(`Unknown mesh attribute: ${t}`)}}),e},c=(t,e,r)=>{let n=0;const s=r?9:6,i=/[a-z_]+(?:\.\w+)?/i;t.push(new o.default(0,null)),i.test(e[0])&&e.splice(0,1);for(let r=0;r<e.length;r+=s)i.test(e[r])?(e.splice(r,1),t[t.length-1].vertexCount=3*n,t.push(new o.default(3*r,null)),n=0,r-=1):n+=1;t[t.length-1].vertexCount=3*n},l=(t,e,r,n)=>{if(e&&e.length>0)if(n){const n=e.length/2*3;for(let s=0;s<n;s+=9){const n=s/9;t.push(r[e[s+0]].getNormal(r[e[s+2]],r[e[s+4]])),e.splice(s+2,0,n),e.splice(s+5,0,n),e.splice(s+8,0,n)}}else{const n=2*e.length;for(let s=0;s<n;s+=6){const n=s/6;t.push(r[e[s+0]].getNormal(r[e[s+1]],r[e[s+2]])),e.splice(s+1,0,n),e.splice(s+3,0,n),e.splice(s+5,0,n)}}else{const e=r.length;for(let n=0;n<e;n+=3){const e=r[n+0].getNormal(r[n+1],r[n+2]);t.push(e,e,e)}}},f=(t,e,r,n,i)=>{const o=i.length/3*5;for(let a=0;a<o;a+=15){const o=r[i[a+0]],u=r[i[a+3]],h=r[i[a+6]],c=n[i[a+1]],l=n[i[a+4]],f=n[i[a+7]],m=u.x-o.x,d=h.x-o.x,p=u.y-o.y,w=h.y-o.y,g=u.z-o.z,y=h.z-o.z,v=l.x-c.x,b=f.x-c.x,x=l.y-c.y,_=f.y-c.y,T=1/(v*_-b*x),E=new s.Vec3((_*m-x*d)*T,(_*p-x*w)*T,(_*g-x*y)*T).normalize,R=new s.Vec3((v*d-b*m)*T,(v*w-b*p)*T,(v*y-b*g)*T).normalize;t.push(E),e.push(R);const S=a/15;i.splice(a+3,0,S,S),i.splice(a+8,0,S,S),i.splice(a+13,0,S,S)}},m=(t,e)=>{const r=n.default.createBuffer();n.default.bindBuffer(n.default.ARRAY_BUFFER,r),n.default.bufferData(n.default.ARRAY_BUFFER,t,n.default.STATIC_DRAW);const s=n.default.createBuffer();return n.default.bindBuffer(n.default.ELEMENT_ARRAY_BUFFER,s),n.default.bufferData(n.default.ELEMENT_ARRAY_BUFFER,e,n.default.STATIC_DRAW),{vertexBuffer:r,indiceBuffer:s}};e.default=class extends i.default{static parse(t,e){const r=[],n=[],i=[],o=[],a=[],d=[],p=[],w=[],g=[],y=/^(\w+) (.+)$/gm,v=/-?\d+\.\d+/g,b=/\d+/g;let x="";if("object"==typeof e){const t=e.vertexData.length;for(let s=0;s<t;s+=2)r.push(e.vertexData[s+0]),n.push(e.vertexData[s+1]);d.push(...e.indices)}else{const t={v:t=>{r.push(new s.Vec3(...t[2].match(v).map(parseFloat)))},vt:t=>{n.push(new s.Vec2(...t[2].match(v).map(parseFloat)))},vn:t=>{i.push(new s.Vec3(...t[2].match(v).map(parseFloat)))},f:t=>{d.push(...t[2].match(b).map(t=>parseInt(t,10)-1))},g:t=>{d.push(t[2])},"#":t=>{},o:t=>{},usemtl:t=>{},s:t=>{},mtllib:t=>{}};for(;x=y.exec(e);)try{t[x[1]](x)}catch(t){throw new Error("Failed at parsing mesh file row.",x,t)}}r.length&&w.push("a_position");const _=!!n.length;if(_&&w.push("a_texcoord"),c(p,d,_),p.forEach(e=>{e.mesh=t}),i.length||l(i,d,r,_),w.push("a_normal"),_&&(f(o,a,r,n,d),w.push("a_tangent","a_bitangent")),n){const t=d.length;for(let e=0;e<t;e+=5)g.push(...r[d[e+0]].toArray),g.push(...n[d[e+1]].toArray),g.push(...i[d[e+2]].toArray),g.push(...o[d[e+3]].toArray),g.push(...a[d[e+4]].toArray)}else{const t=d.length;for(let e=0;e<t;e+=2)g.push(...r[d[e+0]].toArray),g.push(...i[d[e+2]].toArray)}const T=m(new Float32Array(g),new Int16Array(d));t.geometries=p,t.attributes=u(w),t.vertexSize=h(w),t.vertexBuffer=T.vertexBuffer,t.indiceBuffer=T.indiceBuffer}constructor(t){super(t),this.geometries=[],this.attributes=[],this.vertexSize=null,this.vertexBuffer=null,this.indiceBuffer=null}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t){this.node=t}remove(){this.removeReferences(),this.node.removeComponent(this)}}},function(t,e,r){"use strict";t.exports=function(t,e){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return t.apply(e,r)}}},function(t,e,r){"use strict";var n=r(0),s=r(26),i=r(28),o=r(29),a=r(30),u=r(9),h="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||r(31);t.exports=function(t){return new Promise(function(e,c){var l=t.data,f=t.headers;n.isFormData(l)&&delete f["Content-Type"];var m=new XMLHttpRequest,d="onreadystatechange",p=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in m||a(t.url)||(m=new window.XDomainRequest,d="onload",p=!0,m.onprogress=function(){},m.ontimeout=function(){}),t.auth){var w=t.auth.username||"",g=t.auth.password||"";f.Authorization="Basic "+h(w+":"+g)}if(m.open(t.method.toUpperCase(),i(t.url,t.params,t.paramsSerializer),!0),m.timeout=t.timeout,m[d]=function(){if(m&&(4===m.readyState||p)&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in m?o(m.getAllResponseHeaders()):null,n={data:t.responseType&&"text"!==t.responseType?m.response:m.responseText,status:1223===m.status?204:m.status,statusText:1223===m.status?"No Content":m.statusText,headers:r,config:t,request:m};s(e,c,n),m=null}},m.onerror=function(){c(u("Network Error",t,null,m)),m=null},m.ontimeout=function(){c(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",m)),m=null},n.isStandardBrowserEnv()){var y=r(32),v=(t.withCredentials||a(t.url))&&t.xsrfCookieName?y.read(t.xsrfCookieName):void 0;v&&(f[t.xsrfHeaderName]=v)}if("setRequestHeader"in m&&n.forEach(f,function(t,e){void 0===l&&"content-type"===e.toLowerCase()?delete f[e]:m.setRequestHeader(e,t)}),t.withCredentials&&(m.withCredentials=!0),t.responseType)try{m.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&m.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&m.upload&&m.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){m&&(m.abort(),c(t),m=null)}),void 0===l&&(l=null),m.send(l)})}},function(t,e,r){"use strict";var n=r(27);t.exports=function(t,e,r,s,i){var o=new Error(t);return n(o,e,r,s,i)}},function(t,e,r){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,r){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n{constructor(t,e,r,n){this.type=t||null,this.element=t&&(e||window)||null,this.listener=null,this.subscribers=[],this.invoker=null,this.enableInvoke=null===this.type,this.createListener(r||!1,n||!1)}createListener(t,e){this.enableInvoke?this.invoker=((...t)=>this.subscribers.forEach(e=>{e(...t)})):(this.invoker=t&&e?t=>{t.preventDefault(),t.stopPropagation(),this.subscribers.forEach(e=>{e(t)})}:t?t=>{t.preventDefault(),this.subscribers.forEach(e=>{e(t)})}:e?t=>{t.stopPropagation(),this.subscribers.forEach(e=>{e(t)})}:t=>{this.subscribers.forEach(e=>{e(t)})},this.element.addEventListener(this.type,this.invoker,!1))}invoke(){this.enableInvoke&&this.invoker()}subscribe(...t){t.forEach(t=>{this.subscribers.push(t)})}unsubscribe(...t){t.forEach(t=>{const e=this.subscribers.indexOf(t);-1!==e&&this.subscribers.splice(e,1)})}}e.default=n;const s=new n("resize",window,!0,!0),i=new n("keydown",window,!1,!0),o=new n("keyup",window,!0,!0),a=new n("mousedown",window,!0,!0),u=new n("mouseup",window,!0,!0),h=new n("mousemove",window,!0,!0),c=new n("wheel",window,!1,!0),l=new n("contextmenu",window,!1,!0);e.windowResizeEvent=s,e.windowKeyDownEvent=i,e.windowKeyUpEvent=o,e.windowMouseDownEvent=a,e.windowMouseUpEvent=u,e.windowMouseMoveEvent=h,e.windowWheelEvent=c,e.windowContextMenuEvent=l},function(t,e,r){"use strict";r(14);var n=o(r(19)),s=o(r(55)),i=o(r(62));function o(t){return t&&t.__esModule?t:{default:t}}const a=new n.default;a.getResource("scene.cnf",t=>{const e=s.default.createScene(t,a),r=new i.default;setInterval(function(){r.renderScene(e)},500)})},function(t,e,r){var n=r(15);"string"==typeof n&&(n=[[t.i,n,""]]);var s={singleton:!0,sourceMap:!1,convertToAbsoluteUrls:!0,hmr:!0,transform:void 0,insertInto:void 0};r(17)(n,s);n.locals&&(t.exports=n.locals)},function(t,e,r){(t.exports=r(16)(!1)).push([t.i,"\r\n* {\r\n  font-family: 'Ubuntu', sans-serif;\r\n  margin: 0;\r\n  padding: 0;\r\n  box-sizing: border-box;\r\n  font-size: 16px;\r\n}\r\n\r\nhtml body {\r\n  height: 100vh;\r\n  width: 100vw;\r\n  overflow: hidden;\r\n}\r\n\r\n#root {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\ncanvas {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n}\r\n",""])},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var r=function(t,e){var r=t[1]||"",n=t[3];if(!n)return r;if(e&&"function"==typeof btoa){var s=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(n),i=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[r].concat(i).concat([s]).join("\n")}return[r].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r}).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},s=0;s<this.length;s++){var i=this[s][0];"number"==typeof i&&(n[i]=!0)}for(s=0;s<t.length;s++){var o=t[s];"number"==typeof o[0]&&n[o[0]]||(r&&!o[2]?o[2]=r:r&&(o[2]="("+o[2]+") and ("+r+")"),e.push(o))}},e}},function(t,e,r){var n={},s=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),i=function(t){var e={};return function(t){if("function"==typeof t)return t();if(void 0===e[t]){var r=function(t){return document.querySelector(t)}.call(this,t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}}(),o=null,a=0,u=[],h=r(18);function c(t,e){for(var r=0;r<t.length;r++){var s=t[r],i=n[s.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](s.parts[o]);for(;o<s.parts.length;o++)i.parts.push(w(s.parts[o],e))}else{var a=[];for(o=0;o<s.parts.length;o++)a.push(w(s.parts[o],e));n[s.id]={id:s.id,refs:1,parts:a}}}}function l(t,e){for(var r=[],n={},s=0;s<t.length;s++){var i=t[s],o=e.base?i[0]+e.base:i[0],a={css:i[1],media:i[2],sourceMap:i[3]};n[o]?n[o].parts.push(a):r.push(n[o]={id:o,parts:[a]})}return r}function f(t,e){var r=i(t.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=u[u.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),u.push(e);else if("bottom"===t.insertAt)r.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var s=i(t.insertInto+" "+t.insertAt.before);r.insertBefore(e,s)}}function m(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function d(t){var e=document.createElement("style");return void 0===t.attrs.type&&(t.attrs.type="text/css"),p(e,t.attrs),f(t,e),e}function p(t,e){Object.keys(e).forEach(function(r){t.setAttribute(r,e[r])})}function w(t,e){var r,n,s,i;if(e.transform&&t.css){if(!(i=e.transform(t.css)))return function(){};t.css=i}if(e.singleton){var u=a++;r=o||(o=d(e)),n=y.bind(null,r,u,!1),s=y.bind(null,r,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",p(e,t.attrs),f(t,e),e}(e),n=function(t,e,r){var n=r.css,s=r.sourceMap,i=void 0===e.convertToAbsoluteUrls&&s;(e.convertToAbsoluteUrls||i)&&(n=h(n));s&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");var o=new Blob([n],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(o),a&&URL.revokeObjectURL(a)}.bind(null,r,e),s=function(){m(r),r.href&&URL.revokeObjectURL(r.href)}):(r=d(e),n=function(t,e){var r=e.css,n=e.media;n&&t.setAttribute("media",n);if(t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}.bind(null,r),s=function(){m(r)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else s()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var r=l(t,e);return c(r,e),function(t){for(var s=[],i=0;i<r.length;i++){var o=r[i];(a=n[o.id]).refs--,s.push(a)}t&&c(l(t,e),e);for(i=0;i<s.length;i++){var a;if(0===(a=s[i]).refs){for(var u=0;u<a.parts.length;u++)a.parts[u]();delete n[a.id]}}}};var g=function(){var t=[];return function(e,r){return t[e]=r,t.filter(Boolean).join("\n")}}();function y(t,e,r,n){var s=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=g(e,s);else{var i=document.createTextNode(s),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(i,o[e]):t.appendChild(i)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var r=e.protocol+"//"+e.host,n=r+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var s,i=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?t:(s=0===i.indexOf("//")?i:0===i.indexOf("/")?r+i:n+i.replace(/^\.\//,""),"url("+JSON.stringify(s)+")")})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(20)),s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}(r(40));n.default.defaults.baseURL=`${window.location.origin}/api/glib`,n.default.defaults.headers.common.accept="image/png";const i={".png":t=>new s.Texture(t),".obj":t=>new s.Mesh(t),".mtl":t=>new s.Material(t),".glsl":t=>new s.ShaderSource(t),".cnf":t=>new s.SceneSource(t)},o={Plane:t=>new s.Plane(t),Sphere:t=>new s.Sphere(t)},a=t=>{const e=t.slice(t.indexOf("."),t.length);return i[e]?i[e](t):o[t]?o[t](t):void console.error(`No resource for file with url: ${t}`)};e.default=class{constructor(){this.resources=new Map,this.resourceQueue=[],this.allLoadedCallback=null,this.loading=!1}createShape(t,e){let r=0;const n=a(s);let s=t.toLowerCase();for(;this.resources.has(`${s}${r}`);)r+=1;return s+=`${r}`,this.resources.set(n.url,n),n.constructor.generate(n,e),n}getResource(t,e){if(this.resources.has(t))return this.resources.get(t);const r=this.resourceQueue.indexOf(t);if(r>-1)return this.resourceQueue[r];const n=a(t);return this.resourceQueue.push(n),this.loadNextResource(e),n}loadNextResource(t){if(this.loading)return;const e=this.resourceQueue.shift();e?this.resources.has(e.url)?this.loadNextResource():(this.loading=!0,n.default.get(e.url).then(r=>{const n=e.constructor.parse(e,r.data);this.resources.set(e.url,e),n&&n(this),t&&t(e),this.loading=!1,this.loadNextResource()}).catch(t=>{const r=`Unable to load resource ${e.url}`;console.error(r,t),this.resource.set(e.url,{error:r}),this.loading=!1,this.loadNextResource()})):this.allLoaded()}allLoaded(){}}},function(t,e,r){t.exports=r(21)},function(t,e,r){"use strict";var n=r(0),s=r(7),i=r(23),o=r(4);function a(t){var e=new i(t),r=s(i.prototype.request,e);return n.extend(r,i.prototype,e),n.extend(r,e),r}var u=a(o);u.Axios=i,u.create=function(t){return a(n.merge(o,t))},u.Cancel=r(11),u.CancelToken=r(38),u.isCancel=r(10),u.all=function(t){return Promise.all(t)},u.spread=r(39),t.exports=u,t.exports.default=u},function(t,e){function r(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(r(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&r(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,r){"use strict";var n=r(4),s=r(0),i=r(33),o=r(34);function a(t){this.defaults=t,this.interceptors={request:new i,response:new i}}a.prototype.request=function(t){"string"==typeof t&&(t=s.merge({url:arguments[0]},arguments[1])),(t=s.merge(n,{method:"get"},this.defaults,t)).method=t.method.toLowerCase();var e=[o,void 0],r=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)r=r.then(e.shift(),e.shift());return r},s.forEach(["delete","get","head","options"],function(t){a.prototype[t]=function(e,r){return this.request(s.merge(r||{},{method:t,url:e}))}}),s.forEach(["post","put","patch"],function(t){a.prototype[t]=function(e,r,n){return this.request(s.merge(n||{},{method:t,url:e,data:r}))}}),t.exports=a},function(t,e){var r,n,s=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var u,h=[],c=!1,l=-1;function f(){c&&u&&(c=!1,u.length?h=u.concat(h):l=-1,h.length&&m())}function m(){if(!c){var t=a(f);c=!0;for(var e=h.length;e;){for(u=h,h=[];++l<e;)u&&u[l].run();l=-1,e=h.length}u=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function p(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];h.push(new d(t,e)),1!==h.length||c||a(m)},d.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=p,s.addListener=p,s.once=p,s.off=p,s.removeListener=p,s.removeAllListeners=p,s.emit=p,s.prependListener=p,s.prependOnceListener=p,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t,e){n.forEach(t,function(r,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=r,delete t[n])})}},function(t,e,r){"use strict";var n=r(9);t.exports=function(t,e,r){var s=r.config.validateStatus;r.status&&s&&!s(r.status)?e(n("Request failed with status code "+r.status,r.config,null,r.request,r)):t(r)}},function(t,e,r){"use strict";t.exports=function(t,e,r,n,s){return t.config=e,r&&(t.code=r),t.request=n,t.response=s,t}},function(t,e,r){"use strict";var n=r(0);function s(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,r){if(!e)return t;var i;if(r)i=r(e);else if(n.isURLSearchParams(e))i=e.toString();else{var o=[];n.forEach(e,function(t,e){null!==t&&void 0!==t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),o.push(s(e)+"="+s(t))}))}),i=o.join("&")}return i&&(t+=(-1===t.indexOf("?")?"?":"&")+i),t}},function(t,e,r){"use strict";var n=r(0),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,r,i,o={};return t?(n.forEach(t.split("\n"),function(t){if(i=t.indexOf(":"),e=n.trim(t.substr(0,i)).toLowerCase(),r=n.trim(t.substr(i+1)),e){if(o[e]&&s.indexOf(e)>=0)return;o[e]="set-cookie"===e?(o[e]?o[e]:[]).concat([r]):o[e]?o[e]+", "+r:r}}),o):o}},function(t,e,r){"use strict";var n=r(0);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function s(t){var n=t;return e&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return t=s(window.location.href),function(e){var r=n.isString(e)?s(e):e;return r.protocol===t.protocol&&r.host===t.host}}():function(){return!0}},function(t,e,r){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function s(){this.message="String contains an invalid character"}s.prototype=new Error,s.prototype.code=5,s.prototype.name="InvalidCharacterError",t.exports=function(t){for(var e,r,i=String(t),o="",a=0,u=n;i.charAt(0|a)||(u="=",a%1);o+=u.charAt(63&e>>8-a%1*8)){if((r=i.charCodeAt(a+=.75))>255)throw new s;e=e<<8|r}return o}},function(t,e,r){"use strict";var n=r(0);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,r,s,i,o){var a=[];a.push(t+"="+encodeURIComponent(e)),n.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),n.isString(s)&&a.push("path="+s),n.isString(i)&&a.push("domain="+i),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,r){"use strict";var n=r(0);function s(){this.handlers=[]}s.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},s.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},s.prototype.forEach=function(t){n.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=s},function(t,e,r){"use strict";var n=r(0),s=r(35),i=r(10),o=r(4),a=r(36),u=r(37);function h(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return h(t),t.baseURL&&!a(t.url)&&(t.url=u(t.baseURL,t.url)),t.headers=t.headers||{},t.data=s(t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||o.adapter)(t).then(function(e){return h(t),e.data=s(e.data,e.headers,t.transformResponse),e},function(e){return i(e)||(h(t),e&&e.response&&(e.response.data=s(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t,e,r){return n.forEach(r,function(r){t=r(t,e)}),t}},function(t,e,r){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,r){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,r){"use strict";var n=r(11);function s(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var r=this;t(function(t){r.reason||(r.reason=new n(t),e(r.reason))})}s.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},s.source=function(){var t;return{token:new s(function(e){t=e}),cancel:t}},t.exports=s},function(t,e,r){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(41);Object.defineProperty(e,"SceneSource",{enumerable:!0,get:function(){return c(n).default}});var s=r(42);Object.defineProperty(e,"ShaderSource",{enumerable:!0,get:function(){return c(s).default}});var i=r(5);Object.defineProperty(e,"Mesh",{enumerable:!0,get:function(){return c(i).default}});var o=r(51);Object.defineProperty(e,"Material",{enumerable:!0,get:function(){return c(o).default}});var a=r(52);Object.defineProperty(e,"Texture",{enumerable:!0,get:function(){return c(a).default}});var u=r(53);Object.defineProperty(e,"Plane",{enumerable:!0,get:function(){return c(u).default}});var h=r(54);function c(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"Sphere",{enumerable:!0,get:function(){return c(h).default}})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(2));e.default=class extends n.default{static parse(t,e){"object"!=typeof e&&JSON.parse(e),t.data=e}constructor(t){super(t),this.data=null}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(2));e.default=class extends n.default{static parse(t,e){t.shaderText=e}constructor(t){super(t),this.shaderText=null}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n{static get white(){return new n(1,1,1)}static get red(){return new n(1,0,0)}static get green(){return new n(0,1,0)}static get blue(){return new n(0,0,1)}static get black(){return new n(0,0,0)}static fromArray(t){return new n(...t)}static fromHex(t){return new n(...[t.slice(2,4),t.slice(4,6),t.slice(6,8)].map(t=>parseInt(t,16)/255))}constructor(t,e,r){this.r=t||0,this.g=e||0,this.b=r||0}get copy(){return new n(this.r,this.g,this.b)}get toArray(){return[this.r,this.g,this.b]}get toHex(){return`0x${[(255*this.r).toString(16),(255*this.g).toString(16),(255*this.b).toString(16)].map(t=>t.length<2?`'0'${t}`:t).join("")}`}}e.default=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const{sqrt:n}=Math;class s{static get zero(){return new s(0,0)}static get up(){return new s(0,1)}static get down(){return new s(0,-1)}static get left(){return new s(-1,0)}static get right(){return new s(1,0)}static fromArray(t){return new s(...t)}constructor(t,e){this.x=t||0,this.y=e||0}get toArray(){return[this.x,this.y]}get toFloat32Array(){return new Float32Array([this.x,this.y])}get clone(){return new s(this.x,this.y)}get len(){return n(this.x*this.x+this.y*this.y)}get lenSqrt(){return this.x*this.x+this.y*this.y}get normalize(){let t=n(this.x*this.x+this.y*this.y);return t>0?(t=1/t,new s(this.x*t,this.y*t)):new s(0,0)}add(t){return new s(this.x+t.x,this.y+t.y)}sub(t){return new s(this.x-t.x,this.y-t.y)}scale(t){return new s(this.x*t,this.y*t)}dot(t){return this.x*t.x+this.y*t.y}getAngle(t){return this.normalize.dot(t.normalize)}invert(){return new s(-this.x,-this.y)}}e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const{sqrt:n}=Math;class s{static get zero(){return new s(0,0,0)}static get up(){return new s(0,1,0)}static get down(){return new s(0,-1,0)}static get left(){return new s(-1,0,0)}static get right(){return new s(1,0,0)}static get forward(){return new s(0,0,1)}static get backward(){return new s(0,0,-1)}static fromArray(t){return new s(...t)}static fromQuat(t){const e=this.x,r=this.y,n=this.z,i=t.x,o=t.y,a=t.z,u=t.w,h=u*e+o*n-a*r,c=u*r+a*e-i*n,l=u*n+i*r-o*e,f=-i*e-o*r-a*n;return new s(h*u+f*-i+c*-a-l*-o,c*u+f*-o+l*-i-h*-a,l*u+f*-a+h*-o-c*-i)}static fromMat4(t){return new s(t.a14+t.a11*this.x+t.a12*this.y+t.a13*this.z,t.a24+t.a21*this.x+t.a22*this.y+t.a23*this.z,t.a34+t.a31*this.x+t.a32*this.y+t.a33*this.z)}constructor(t,e,r){this.x=t||0,this.y=e||0,this.z=r||0}get forward(){return this.normalize}get backward(){return this.normalize.invert}get left(){return this.forward.cross(s.up).normalize}get right(){return this.forward.cross(s.up).normalize.invert}get down(){return this.forward.cross(this.left).normalize}get up(){return this.forward.cross(this.left).normalize.invert}get toArray(){return[this.x,this.y,this.z]}get toFloat32Array(){return new Float32Array([this.x,this.y,this.z])}get clone(){return new s(this.x,this.y,this.z)}get len(){return n(this.x*this.x+this.y*this.y+this.z*this.z)}get lenSqrt(){return this.x*this.x+this.y*this.y+this.z*this.z}get normalize(){let t=n(this.x*this.x+this.y*this.y+this.z*this.z);return t>0?(t=1/t,new s(this.x*t,this.y*t,this.z*t)):new s(0,0,0)}get invert(){return new s(-this.x,-this.y,-this.z)}add(t){return new s(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new s(this.x-t.x,this.y-t.y,this.z-t.z)}scale(t){return new s(this.x*t,this.y*t,this.z*t)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){return new s(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}lerp(t,e){return new s(this.x+(t.x-this.x)*e,this.y+(t.y-this.y)*e,this.z+(t.z-this.z)*e)}getNormal(t,e){return this.sub(t).cross(this.sub(e)).normalize}getAngle(t){return this.normalize.dot(t.normalize)}}e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);const{sqrt:s}=Math;class i{static get identity(){return new i(1,0,0,0,1,0,0,0,1)}constructor(t,e,r,n,s,i,o,a,u){this.m00=t,this.m01=e,this.m02=r,this.m10=n,this.m11=s,this.m12=i,this.m20=o,this.m21=a,this.m22=u}get clone(){return new i(this.m00,this.m01,this.m02,this.m10,this.m11,this.m12,this.m20,this.m21,this.m22)}get toArray(){return[this.m00,this.m01,this.m02,this.m10,this.m11,this.m12,this.m20,this.m21,this.m22]}get toFloat32Array(){return new Float32Array([this.m00,this.m01,this.m02,this.m10,this.m11,this.m12,this.m20,this.m21,this.m22])}get toMat4(){return new n.Mat4(this.m00,this.m01,this.m02,0,this.m10,this.m11,this.m12,0,this.m20,this.m21,this.m22,0,0,0,0,1)}get toQuat(){const t=this.m00+this.m11+this.m22;let e;return t>0?(e=.5/s(t+1),new n.Quat(.25/e,(this.m21-this.m12)*e,(this.m02-this.m20)*e)):this.m00>this.m11&&this.m00>this.m22?(e=2*s(1+this.m00-this.m11-this.m22),new n.Quat((this.m21-this.m12)/e,.25*e,(this.m01+this.m10)/e,(this.m02+this.m20)/e)):this.m11>this.m22?(e=2*s(1+this.m11-this.m00-this.m22),new n.Quat((this.m02-this.m20)/e,(this.m01+this.m10)/e,.25*e,(this.m12+this.m21)/e)):(e=2*s(1+this.m22-this.m00-this.m11),new n.Quat((this.m10-this.m01)/e,(this.m02+this.m20)/e,(this.m12+this.m21)/e))}multiplyVector(t){return new i(this.m00*t.x+this.m01*t.y+this.m02*t.z,this.m10*t.x+this.m11*t.y+this.m12*t.z,this.m20*t.x+this.m21*t.y+this.m22*t.z)}add(t){return new i(this.m00+t.m00,this.m01+t.m01,this.m02+t.m02,this.m10+t.m10,this.m11+t.m11,this.m12+t.m12,this.m20+t.m20,this.m21+t.m21,this.m22+t.m22)}sub(t){return new i(this.m00-t.m00,this.m01-t.m01,this.m02-t.m02,this.m10-t.m10,this.m11-t.m11,this.m12-t.m12,this.m20-t.m20,this.m21-t.m21,this.m22-t.m22)}mul(t){const e=this.m01,r=this.m02,n=this.m03,s=this.m11,o=this.m12,a=this.m13,u=this.m21,h=this.m22,c=this.m23,l=t.m01,f=t.m02,m=t.m03,d=t.m11,p=t.m12,w=t.m13,g=t.m21,y=t.m22,v=t.m23;return new i(e*l+r*d+n*g,e*f+r*p+n*y,e*m+r*w+n*v,s*l+o*d+a*g,s*f+o*p+a*y,s*m+o*w+a*v,u*l+h*d+c*g,u*f+h*p+c*y,u*m+h*w+c*v)}}e.default=i,i.fromArray=(t=>new i(...t))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);const{sin:s,cos:i,tan:o}=Math;class a{static get identity(){return new a(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}static fromArray(t){return new a(...t)}static perspective(t,e,r,n){const s=1/o(t/2),i=1/(r-n);return new a(s/e,0,0,0,0,s,0,0,0,0,(r+n)*i,-1,0,0,r*n*i*2,0)}static orthographic(t,e,r,n,s,i){const o=1/(t-e),u=1/(r-n),h=1/(s-i);return new a(2*o,0,0,0,0,2*u,0,0,0,0,2*h,0,(t+e)*o,(n+r)*u,(i+s)*h,1)}static translate(t,e,r){return new a(1,0,0,0,0,1,0,0,0,0,1,0,t,e,r,1)}static scale(t,e,r){return new a(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1)}static rotateX(t){const e=i(t),r=s(t);return new a(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1)}static rotateY(t){const e=i(t),r=s(t);return new a(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1)}static rotateZ(t){const e=i(t),r=s(t);return new a(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1)}constructor(t,e,r,n,s,i,o,a,u,h,c,l,f,m,d,p){this.m00=t||0,this.m01=e||0,this.m02=r||0,this.m03=n||0,this.m10=s||0,this.m11=i||0,this.m12=o||0,this.m13=a||0,this.m20=u||0,this.m21=h||0,this.m22=c||0,this.m23=l||0,this.m30=f||0,this.m31=m||0,this.m32=d||0,this.m33=p||0}get clone(){return new a(this.m00,this.m01,this.m02,this.m03,this.m10,this.m11,this.m12,this.m13,this.m20,this.m21,this.m22,this.m23,this.m30,this.m31,this.m32,this.m33)}get toArray(){return[this.m00,this.m01,this.m02,this.m03,this.m10,this.m11,this.m12,this.m13,this.m20,this.m21,this.m22,this.m23,this.m30,this.m31,this.m32,this.m33]}get toFloat32Array(){return new Float32Array([this.m00,this.m01,this.m02,this.m03,this.m10,this.m11,this.m12,this.m13,this.m20,this.m21,this.m22,this.m23,this.m30,this.m31,this.m32,this.m33])}get toMat3(){return new n.Mat3(this.m00,this.m01,this.m02,this.m10,this.m11,this.m12,this.m20,this.m21,this.m22)}get toQuat(){return this.toMat3.toQuat}get invert(){const{m00:t,m01:e,m02:r,m03:n,m10:s,m11:i,m12:o,m13:u,m20:h,m21:c,m22:l,m23:f,m30:m,m31:d,m32:p,m33:w}=this,g=i*l*w-i*f*p-c*o*w+c*u*p+d*o*f-d*u*l,y=-s*l*w+s*f*p+h*o*w-h*u*p-m*o*f+m*u*l,v=s*c*w-s*f*d-h*i*w+h*u*d+m*i*f-m*u*c,b=-s*c*p+s*l*d+h*i*p-h*o*d-m*i*l+m*o*c;let x=t*g+e*y+r*v+n*b;if(0===x)throw new Error("Cannot invert matrix",this);return new a((x=1/x)*g,x*-e*l*w+e*f*p+c*r*w-c*n*p-d*r*f+d*n*l,x*e*o*w-e*u*p-i*r*w+i*n*p+d*r*u-d*n*o,x*-e*o*f+e*u*l+i*r*f-i*n*l-c*r*u+c*n*o,x*y,x*t*l*w-t*f*p-h*r*w+h*n*p+m*r*f-m*n*l,x*-t*o*w+t*u*p+s*r*w-s*n*p-m*r*u+m*n*o,x*t*o*f-t*u*l-s*r*f+s*n*l+h*r*u-h*n*o,x*v,x*-t*c*w+t*f*d+h*e*w-h*n*d-m*e*f+m*n*c,x*t*i*w-t*u*d-s*e*w+s*n*d+m*e*u-m*n*i,x*-t*i*f+t*u*c+s*e*f-s*n*c-h*e*u+h*n*i,x*b,x*t*c*p-t*l*d-h*e*p+h*r*d+m*e*l-m*r*c,x*-t*i*p+t*o*d+s*e*p-s*r*d-m*e*o+m*r*i,x*t*i*l-t*o*c-s*e*l+s*r*c+h*e*o-h*r*i)}get transpose(){return new a(this.m00,this.m10,this.m20,this.m30,this.m01,this.m11,this.m21,this.m31,this.m02,this.m12,this.m22,this.m32,this.m03,this.m13,this.m23,this.m33)}get translation(){return new n.Vec3(this.m30,this.m31,this.m32)}get scale(){return new n.Vec3(new n.Vec3(this.m00,this.m10,this.m20).len,new n.Vec3(this.m01,this.m11,this.m21).len,new n.Vec3(this.m02,this.m12,this.m22).len)}get rotation(){return new n.Mat3(this.m00,this.m01,this.m02,this.m10,this.m11,this.m12,this.m20,this.m21,this.m22)}lookAt(t,e){const r=this.sub(t).normalize,n=e.cross(r),s=r.cross(n);return new a(n.x,n.y,n.z,0,s.x,s.y,s.z,0,r.x,r.y,r.z,0,this.x,this.y,this.z,1)}add(t){return new a(this.m00+t.m00,this.m01+t.m01,this.m02+t.m02,this.m03+t.m03,this.m10+t.m10,this.m11+t.m11,this.m12+t.m12,this.m13+t.m13,this.m20+t.m20,this.m21+t.m21,this.m22+t.m22,this.m23+t.m23,this.m30+t.m30,this.m31+t.m31,this.m32+t.m32,this.m33+t.m33)}sub(t){return new a(this.m00-t.m00,this.m01-t.m01,this.m02-t.m02,this.m03-t.m03,this.m10-t.m10,this.m11-t.m11,this.m12-t.m12,this.m13-t.m13,this.m20-t.m20,this.m21-t.m21,this.m22-t.m22,this.m23-t.m23,this.m30-t.m30,this.m31-t.m31,this.m32-t.m32,this.m33-t.m33)}mul(t){return new a(t.m00*this.m00+t.m01*this.m10+t.m02*this.m20+t.m03*this.m30,t.m00*this.m01+t.m01*this.m11+t.m02*this.m21+t.m03*this.m31,t.m00*this.m02+t.m01*this.m12+t.m02*this.m22+t.m03*this.m32,t.m00*this.m03+t.m01*this.m13+t.m02*this.m23+t.m03*this.m33,t.m10*this.m00+t.m11*this.m10+t.m12*this.m20+t.m13*this.m30,t.m10*this.m01+t.m11*this.m11+t.m12*this.m21+t.m13*this.m31,t.m10*this.m02+t.m11*this.m12+t.m12*this.m22+t.m13*this.m32,t.m10*this.m03+t.m11*this.m13+t.m12*this.m23+t.m13*this.m33,t.m20*this.m00+t.m21*this.m10+t.m22*this.m20+t.m23*this.m30,t.m20*this.m01+t.m21*this.m11+t.m22*this.m21+t.m23*this.m31,t.m20*this.m02+t.m21*this.m12+t.m22*this.m22+t.m23*this.m32,t.m20*this.m03+t.m21*this.m13+t.m22*this.m23+t.m23*this.m33,t.m30*this.m00+t.m31*this.m10+t.m32*this.m20+t.m33*this.m30,t.m30*this.m01+t.m31*this.m11+t.m32*this.m21+t.m33*this.m31,t.m30*this.m02+t.m31*this.m12+t.m32*this.m22+t.m33*this.m32,t.m30*this.m03+t.m31*this.m13+t.m32*this.m23+t.m33*this.m33)}}e.default=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);const{sin:s,cos:i,acos:o,abs:a,sqrt:u}=Math;class h{static get identity(){return new h(1,0,0,0)}static get up(){return new h(.707,.707,0,0)}static get down(){return new h(.707,-.707,0,0)}static get left(){return new h(.707,0,.707,0)}static get right(){return new h(.707,0,-.707,0)}static get backward(){return new h(0,0,1,0)}static get upsideDown(){return new h(0,0,0,1)}static get tiltLeft(){return new h(.707,0,0,.707)}static get tiltRight(){return new h(.707,0,0,-.707)}static fromArray(t){return new h(...t)}static fromEulers(t,e,r){const n=i(.5*e),o=i(.5*r),a=i(.5*t),u=s(.5*e),c=s(.5*r),l=s(.5*t);return new h(n*o*a-u*c*l,n*o*l+u*c*a,u*o*a+n*c*l,n*c*a-u*o*l).normalize}static fromAxisAngle(t,e){const r=1/t.len,n=s(e/2);return new h(i(e/2),n*t.x*r,n*t.y*r,n*t.z*r).normalize}static fromRotation(t,e){const r=t.add(e),n=t.cross(r),s=t.dot(r);return new h(s,n.x,n.y,n.z).normalize}constructor(t,e,r,n){this.w=t||0,this.x=e||0,this.y=r||0,this.z=n||0}get clone(){return new h(this.w,this.x,this.y,this.z)}get toArray(){return[this.w,this.x,this.y,this.z]}get toMat3(){const{w:t,x:e,y:r,z:s}=this,i=e*t,o=e*e,a=e*r,u=e*s,h=r*t,c=r*r,l=r*s,f=s*t,m=s*s;return new n.Mat3(1-2*(c+m),2*(a-f),2*(u+h),2*(a+f),1-2*(o+m),2*(l-i),2*(u-h),2*(l+i),1-2*(o+c))}get toMat4(){return this.toMat3.toMat4}get toEulers(){throw new Error("Quaternion toEuler not implemented")}get len(){return u(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z)}get lenSqrt(){return this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z}get conjugate(){return new h(this.w,-this.x,-this.y,-this.z)}get normalize(){let t=u(this.w*this.w+this.x*this.x+this.y*this.y+this.z*this.z);return t>0?(t=1/t,new h(this.w*t,this.x*t,this.y*t,this.z*t)):new h(1,0,0,0)}get invert(){const t=1/this.len;return new h(this.w*t,-this.x*t,-this.y*t,-this.z*t)}mul(t){const e=this.w,r=this.x,n=this.y,s=this.z,i=t.w,o=t.x,a=t.y,u=t.z;return new h(e*i-r*o-n*a-s*u,r*i+e*o+n*u-s*a,n*i+e*a+s*o-r*u,s*i+e*u+r*a-n*o).normalize}dot(t){return this.w*t.w+this.x*t.x+this.y*t.y+this.z*t.z}cross(t){throw new Error(`Quaternion cross not implemented ${t}`)}scaleRotation(t){const e=o(this.w)*t,r=new n.Vec3(this.x,this.y,this.z).scale(s(e));return new h(i(e),r.x,r.y,r.z)}lerp(t,e){return e>=1?t:this.scaleRotation(1-e).multiply(t.scaleRotation(e))}nlerp(t,e){return this.lerp(t,e).normalize}slerp(t,e){if(e<=0)return this;if(e>=1)return t;let r=this.dot(t);if(a(r)>=1)return this;r<0&&(t.w=-t.w,t.x=-t.x,t.y=-t.y,t.z=-t.z,r=-r);const n=u(1-r*r);if(a(n)<.001)return new h(.5*(this.w+t.w),.5*(this.x+t.x),.5*(this.y+t.y),.5*(this.z+t.z)).normalize;const i=o(r),c=s((1-e)*i)/n,l=s(e*i)/n;return new h(this.w*c+t.w*l,this.x*c+t.x*l,this.y*c+t.y*l,this.z*c+t.z*l).normalize}}e.default=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{static linear(t){return t}static easeInQuad(t){return t*t}static easeOutQuad(t){return t*(2-t)}static easeInOutQuad(t){return t<.5?2*t*t:(4-2*t)*t-1}static easeInCubic(t){return t*t*t}static easeOutCubic(t){return(t-=1)*t*t+1}static easeInOutCubic(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1}static easeInQuart(t){return t*t*t*t}static easeOutQuart(t){return 1-(t-=1)*t*t*t}static easeInOutQuart(t){return t<.5?8*t*t*t*t:1-8*(t-=1)*t*t*t}static easeInQuint(t){return t*t*t*t*t}static easeOutQuint(t){return 1+(t-=1)*t*t*t*t}static easeInOutQuint(t){return t<.5?16*t*t*t*t*t:1+16*(t-=1)*t*t*t*t}constructor(){throw new Error("You should not use Easing contructor...")}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=class{constructor(t,e){this.mesh=null,this.vertexOffset=t,this.vertexCount=e}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(2));e.default=class extends n.default{static parse(t,e){return"object"!=typeof e&&JSON.parse(e),t.setDefines(e.defines),r=>{t.setTextures(Object.entries(e.textures).reduce((t,e)=>(t[e[0]]=r.getResource(e[1].src),t),{}))}}constructor(t){super(t),this.textures=new Map,this.defines=new Map}setTextures(t){Object.entries(t).forEach((t,e)=>{e?this.textures.set(t,e):this.textures.delete(t)})}setDefines(t){Object.entries(t).forEach((t,e)=>{this.defines.has(t)?this.defines.delete(t):this.defines.set(t,e||null)})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(r(3)),s=i(r(2));function i(t){return t&&t.__esModule?t:{default:t}}const o=t=>{const e=t.width,r=t.height,s=n.default.createTexture();return n.default.bindTexture(n.default.TEXTURE_2D,s),n.default.texImage2D(n.default.TEXTURE_2D,0,n.default.RGBA,e,r,0,n.default.RGBA,n.default.UNSIGNED_BYTE,t),e&e-1==0&&r&r-1==0?n.default.generateMipmap(n.default.TEXTURE_2D):(n.default.texParameteri(n.default.TEXTURE_2D,n.default.TEXTURE_WRAP_S,n.default.CLAMP_TO_EDGE),n.default.texParameteri(n.default.TEXTURE_2D,n.default.TEXTURE_WRAP_T,n.default.CLAMP_TO_EDGE),n.default.texParameteri(n.default.TEXTURE_2D,n.default.TEXTURE_MIN_FILTER,n.default.LINEAR)),s};e.default=class extends s.default{static parse(t,e){const r=new Image;r.src=`data:image/png;base64,${e}`,t.buffer=o(r)}constructor(t){super(t),this.buffer=null}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(5)),s=r(1);class i extends n.default{}e.default=i,i.generate=((t,{width:e,depth:r})=>{e/=2;let n=[],i=[],o=0;for(let t=-(r/=2);t<r-1;t+=1)for(let r=-e;r<e-1;r+=1)n.push(new s.Vec3(r,0,t)),n.push(new s.Vec2(0,0)),i[o]=o,o+=1,n.push(new s.Vec3(r,0,t+1)),n.push(new s.Vec2(0,1)),i[o]=o,o+=1,n.push(new s.Vec3(r+1,0,t+1)),n.push(new s.Vec2(1,1)),i[o]=o,o+=1,n.push(new s.Vec3(r,0,t)),n.push(new s.Vec2(0,0)),i[o]=o,o+=1,n.push(new s.Vec3(r+1,0,t+1)),n.push(new s.Vec2(1,1)),i[o]=o,o+=1,n.push(new s.Vec3(r+1,0,t)),n.push(new s.Vec2(1,0)),i[o]=o,o+=1;t.constructor.parse(t,{vertexData:n,indices:i})})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(5));r(1);class s extends n.default{}e.default=s,s.generate=((t,{radius:e})=>{})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(56)),s=r(58),i=r(1);const o=(t,e,r)=>{t.forEach(t=>{const n=e.addChild();if(t.transform&&(n.transform.translation=new i.Vec3(t.transform.translation.x||0,t.transform.translation.y||0,t.transform.translation.z||0),n.transform.rotation=i.Quat.fromEulers(t.transform.rotation.x||0,t.transform.rotation.y||0,t.transform.rotation.z||0),n.transform.scale=new i.Vec3(t.transform.scale.x||0,t.transform.scale.y||0,t.transform.scale.z||0)),t.components)for(let e in t.components){let i;switch(e){case"model":(i=n.addComponent(s.Model)).addMesh(r.getResource(t.components[e].mesh)),t.components[e].materials.forEach(t=>{i.addMaterial(r.getResource(t))});break;case"camera":(i=n.addComponent(s.Camera)).active=t.components[e].active}}t.nodes&&o(t.nodes,n,r)})};class a extends n.default{static createScene(t,e){const r=new a(t),{data:n}=t;return n.transform&&(r.transform.translation=new i.Vec3(n.transform.translation.x||0,n.transform.translation.y||0,n.transform.translation.z||0),r.transform.rotation=i.Quat.fromEulers(n.transform.rotation.x||0,n.transform.rotation.y||0,n.transform.rotation.z||0),r.transform.scale=new i.Vec3(n.transform.scale.x||0,n.transform.scale.y||0,n.transform.scale.z||0)),o(n.nodes,r,e),r}constructor(t){super(),this.source=t||null,this.scene=this,this.nodeRegister=[],this.componentRegister=[],this.ambientLightStrength=.5,this.ambientLightColor=new i.Vec3(1,1,1)}addToNodeRegister(t){this.nodeRegister.push(t)}removeFromNodeRegister(t){this.nodeRegister.splice(this.nodeRegister.indexOf(t),1)}addToComponentRegister(t){this.componentRegister.push(t)}removeFromComponentRegister(t){this.componentRegister.splice(this.componentRegister.indexOf(t),1)}remove(){for(const t of this.children)t.remove();for(;this.components.length>0;)this.components[this.components.length-1].remove()}}e.default=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(57));class s{constructor(t,e){this.children=[],this.components=[],this.transform=new n.default(this),this.scene=t||null,this.parent=e||null}addChild(){const t=new s(this.scene,this);return this.scene.addToNodeRegister(t),this.children.push(t),t}removeChild(t){t.scene=null,t.parent=null,t.transfrom.node=null,t.transfrom=null,this.scene.removeFromNodeRegister(t),this.children.splice(this.children.indexOf(t),1)}addComponent(t){const e=new t(this);return this.scene.addToComponentRegister(e),this.components.push(e),e}removeComponent(t){t.node=null,this.scene.removeFromComponentRegister(t),this.components.splice(this.components.indexOf(t),1)}remove(){const{children:t,components:e,parent:r}=this;for(;t.length;)t[t.length-1].remove();for(;e.length;)e[e.length-1].remove();r.removeChild(this)}walkEnabled(t){for(const e of this.children)e.walkEnabled(t);t(this)}}e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1);e.default=class{constructor(t){this.node=t||null,this._startTranslation=null,this._targetTranslation=null,this._startRotation=null,this._targetRotation=null,this._startScale=null,this._targetScale=null,this._origin=n.Vec3.zero,this._rotateAroundOrigin=!1,this._localTranslation=n.Vec3.zero,this._localScale=n.Vec3.one,this._localRotation=n.Quat.identity,this._localTransformUnscaled=n.Mat4.identity,this._localTransform=n.Mat4.identity,this._worldTransformUnscaled=n.Mat4.identity,this._worldTransform=n.Mat4.identity,this._worldTransformDirty=!0}get right(){const{m00:t,m10:e,m20:r}=this.worldTransform;return new n.Vec3(t,e,r)}get up(){const{m01:t,m11:e,m21:r}=this.worldTransform;return new n.Vec3(t,e,r)}get forward(){const{m02:t,m12:e,m22:r}=this.worldTransform;return new n.Vec3(t,e,r)}set translation(t){this.setWorldTransformDirty(),this._localTranslation=t}set rotation(t){this.setWorldTransformDirty(),this._localRotation=t}set scale(t){this.setWorldTransformDirty(),this._localScale=t}set origin(t){this._rotateAroundOrigin=0!==t.lenSqrt,this._origin=t}get translation(){return this._localTranslation}get rotation(){return this._localRotation}get scale(){return this._localScale}get origin(){return this._origin}get worldTransform(){return this._worldTransformDirty&&this.updateWorldTransform(),this._worldTransform.clone}get worldTransformUnscaled(){return this._worldTransformDirty&&this.updateWorldTransform(),this._worldTransformUnscaled.clone}translate(t){this.setWorldTransformDirty(),this._localTranslation=this._localTranslation.add(t)}rotate(t){this.setWorldTransformDirty(),this._localRotation=this._localRotation.mul(t)}setWorldTransformDirty(){this._worldTransformDirty||this.node.walkEnabled(t=>{t.transform._worldTransformDirty=!0})}updateLocalTransform(){const t=n.Mat4.identity,e=this._localTranslation,r=this._localRotation.toMat3,s=this._localScale;if(t.m00=r.m00,t.m01=r.m01,t.m02=r.m02,t.m10=r.m10,t.m11=r.m11,t.m12=r.m12,t.m20=r.m20,t.m21=r.m21,t.m22=r.m22,this._rotateAroundOrigin){const{x:n,y:s,z:i}=this._origin;t.m30=n*r.m00+s*r.m10+i*r.m20+e.x,t.m31=n*r.m01+s*r.m11+i*r.m21+e.y,t.m32=n*r.m02+s*r.m12+i*r.m22+e.z}else t.m30=e.x,t.m31=e.y,t.m32=e.z;this._localTransformUnscaled=t.clone,t.m00*=s.x,t.m01*=s.x,t.m02*=s.x,t.m10*=s.y,t.m11*=s.y,t.m12*=s.y,t.m20*=s.z,t.m21*=s.z,t.m22*=s.z,this._localTransform=t}updateWorldTransform(){this.updateLocalTransform(),this.node.parent?(this._worldTransformUnscaled=this.node.parent.transform.worldTransformUnscaled.mul(this._localTransformUnscaled),this._worldTransform=this.node.parent.transform.worldTransformUnscaled.mul(this._localTransform)):(this._worldTransformUnscaled=this._localTransformUnscaled.copy,this._worldTransform=this._localTransform.copy),this._worldTransformDirty=!1}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(59);Object.defineProperty(e,"Camera",{enumerable:!0,get:function(){return o(n).default}});var s=r(60);Object.defineProperty(e,"Model",{enumerable:!0,get:function(){return o(s).default}});var i=r(61);function o(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"Light",{enumerable:!0,get:function(){return o(i).default}})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(6)),s=r(1),i=r(12);const{PI:o}=Math;e.default=class extends n.default{constructor(t){super(t),this.update=(()=>{}),this.active=!0,this.inControl=!0,this._perspective=s.Mat4.perspective(.25*o,window.innerWidth/window.innerHeight,.01,1e3),this.resize=(()=>{this.perspective=s.Mat4.perspective(.25*o,window.innerWidth/window.innerHeight,.01,1e3)}),i.windowResizeEvent.subscribe(this.resize)}get view(){return this.node.transform.worldTransform}set perspective(t){this._perspective=t}get perspective(){return this._perspective.clone}removeReferences(){i.windowResizeEvent.unsubscribe(this.resize)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(6));e.default=class extends n.default{constructor(t){super(t),this.mesh=null,this.materials=[]}addMesh(t){this.mesh=t}addMaterial(t){this.materials.push(t)}getGeometries(){return this.mesh&&this.mesh.geometries||null}getMaterials(){return this.materials.length?this.materials:null}removeReferences(){this.mesh=null,this.materials.length=0}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(6)),s=r(1);e.default=class extends n.default{constructor(t){super(t),this.type="POINTLIGHT",this.color=s.Color.white,this.range=0,this.diffuseStrength=1,this.specularStrength=1,this.shininess=32,this.debug=!1}setAttributes(t){for(let[e,r]of Object.entires(t))this[e]&&(this[e]=r)}removeReferences(){}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(r(3)),s=r(63),i=o(r(64));function o(t){return t&&t.__esModule?t:{default:t}}e.default=class{constructor(){this.queueGeometry=((t,e,r,n)=>{for(const s of n)if(s.geometry===t&&s.material===e)return void s.worldTransforms.push(r);n.push(new s.GeometryBatch(t,e,r))}),this.queueLight=((t,e)=>{for(const r of e)if(r.type===t.type)return r.color.push(t.color),r.range.push(t.range),r.diffuseStrength.push(t.diffuseStrength),r.specularStrength.push(t.specularStrength),r.shininess.push(t.shininess),void r.worldTransforms.push(t.node.transform.worldTransform);e.push(new s.LightBatch(t.type,t.color,t.range,t.diffuseStrength,t.specularStrength,t.shininess,t.node.transform.worldTransform))}),this.bindAll=((t,e,r,n,s)=>{const i=this.bindMaterial(s);i&&this.bindLights(e),(i||this.boundScene!==t)&&this.bindScene(),(i||this.boundMesh!==n)&&(this.boundMesh=n,this.bindShaderAttributes(),this.enableShaderAttributes(n)),(i||this.boundCamera!==r)&&this.bindCamera(r)}),this.bindShaderProgram=(t=>{this.boundShaderProgram!==t&&(this.boundShaderProgram=t,n.default.useProgram(t.program))}),this.bindLights=(t=>{const e=this.boundShaderProgram.uniformLocations;if(!e["light[0].color"])return;let r=0;for(const s of t){const t=s.worldTransforms.length;for(let i=0;i<t;i+=1){let t;if("POINTLIGHT"===s.type&&(t=1),n.default.uniform1i(e[`light[${r}].type`],t),n.default.uniform3fv(e[`light[${r}].color`],s.color[i].toArray),n.default.uniform1f(e[`light[${r}].range`],s.range[i]),n.default.uniform1f(e[`light[${r}].diffuseStrength`],s.diffuseStrength[i]),n.default.uniform1f(e[`light[${r}].specularStrength`],s.specularStrength[i]),n.default.uniform1f(e[`light[${r}].shininess`],s.shininess[i]),n.default.uniformMatrix4fv(e[`light[${r}].transform`],!1,s.worldTransforms[i].toFloat32Array),r>4)return;r+=1}}}),this.boundScene=null,this.boundCamera=null}renderScene(t){this.boundScene=t;const e=[],r=[];t.walkEnabled(t=>{for(const n of t.components)switch(n.constructor.name){case"Model":this.queueRenderable(n,e);break;case"Light":this.queueLight(n,r);break;case"Camera":n.active&&(this.boundCamera=n)}}),n.default.clearColor(.4,.4,.4,1),n.default.clear(n.default.COLOR_BUFFER_BIT|n.default.DEPTH_BUFFER_BIT),this.renderPass(e,r)}queueRenderable(t,e){if(!t.mesh)throw new Error("Renderable mesh missing from ",t);const r=t.getGeometries(),n=t.getMaterials();if(r&&n)for(let s=0;s<r.length;s+=1)this.queueGeometry(r[s],n[s]||this.defaultMaterial,t.node.transform.worldTransform,e)}renderPass(t,e){n.default.frontFace(n.default.CCW),n.default.enable(n.default.CULL_FACE),n.default.enable(n.default.DITHER),n.default.enable(n.default.DEPTH_TEST),n.default.depthMask(!0);for(const r of t){const{material:t,geometry:{mesh:s,vertexCount:i,vertexOffset:o}}=r;this.bindAll(e,s,t),this.drawIndividual(r,n.default.TRIANGLES,i,n.default.UNSIGNED_SHORT,o)}this.boundMaterial=null,this.boundMesh=null,this.boundScene=null,this.boundShaderProgram=null,this.boundCamera=null}bindMaterial(t){if(this.boundMaterial===t)return!1;let e;this.boundMaterial=t;const r=i.default.getShaderProgramKey(t.name,t.defines);this.shaderProgramCache.has(r)?e=this.shaderProgramCache.get(r):((e=new i.default(i.default.getSource("shaderProgramCode"),t.defines,r)).buildFromDefines(),this.shaderProgramCache.set(r,e)),t.shaderProgram=e,this.bindShaderProgram(e);const s=this.boundShaderProgram.uniformLocations,o=t.textures.entries();for(const[t,e]of o){let r,i;switch(t){case"COLORMAP":r=0,i=s.u_colorTexture;break;case"NORMALMAP":r=1,i=s.u_normalTexture;break;case"SPECULARMAP":r=2,i=s.u_specularTexture;break;default:throw new Error(`No texture of type ${t} has been specified`)}n.default.activeTexture(n.default.TEXTURE0+r),n.default.bindTexture(n.default.TEXTURE_2D,e.buffer),n.default.uniform1i(i,r)}return!0}bindScene(){const t=this.boundShaderProgram.uniformLocations,{ambientLightStrength:e,ambientLightColor:r}=this.scene.ambientLightStrength,s=r.toArray.map(t=>t*e);n.default.uniform3fv(t.u_ambientLight,s),n.default.uniform1f(t.u_time,performance.now()||0)}bindCamera(){const t=this.boundShaderProgram.uniformLocations;n.default.uniformMatrix4fv(t.u_perspective,!1,this.boundCamera.perspective.toFloat32Array),n.default.uniformMatrix4fv(t.u_view,!1,this.boundCamera.view.toFloat32Array),n.default.uniformMatrix4fv(t.u_invertedView,!1,this.boundCamera.view.toFloat32Array.invert)}bindShaderAttributes(){n.default.bindBuffer(n.default.ARRAY_BUFFER,this.boundMesh.vertexBuffer),n.default.bindBuffer(n.default.ELEMENT_ARRAY_BUFFER,this.boundMesh.indiceBuffer)}enableShaderAttributes(){const t=this.boundShaderProgram.attributeLocations,{attributes:e,vertexSize:r}=this.boundMesh;for(const s of e){const{name:e,vertices:i,offset:o}=s;n.default.enableVertexAttribArray(t[e]),n.default.vertexAttribPointer(t[e],i,n.default.FLOAT,!1,4*r,4*o)}}drawIndividual(t,e,r,s,i){for(const o of t.worldTransforms)this.bindTransform(o),n.default.drawElements(e,r,s,2*i)}bindTransform(t){const e=this.boundShaderProgram.uniformLocations,{perspective:r,view:s}=this.boundCamera,i=s.invert.mul(t),o=r.mul(i);n.default.uniformMatrix4fv(e.u_model,!1,t.toFloat32Array),n.default.uniformMatrix4fv(e.u_mv,!1,i.toFloat32Array),n.default.uniformMatrix4fv(e.u_mvp,!1,o.toFloat32Array)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.GeometryBatch=class{constructor(t,e,r){this.geometry=t||null,this.material=e||null,this.worldTransforms=[r]}};e.LightBatch=class{constructor(t,e,r,n,s,i,o){this.type=t||null,this.color=[e],this.range=[r],this.diffuseStrength=[n],this.specularStrength=[s],this.shininess=[i],this.worldTransforms=[o]}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(r(3));class s{constructor(t,e,r){if(i.call(this),!r)throw new Error("Shader program must have a key!");this.key=r||null,this.program=null,this.attributeLocations={},this.uniformLocations={},this.source=t||null,this.defines=e||null}}e.default=s,s.createShaderProgramKey=((t,e)=>`${t}(${e.map((t,e)=>`${e}=${t};`)})`);var i=function(){this.buildFromDefines=(()=>{if(!this.defines)throw new Error("No definitions found and/or provided for building a shader");this.program=this.createShaderProgram(this.source,this.defines),this.attributeLocations=this.getAttributeLocations(this.program),this.uniformLocations=this.getUniformLocations(this.program)}),this.createShaderProgram=((t,e)=>{const r=n.default.createProgram();if(n.default.attachShader(r,this.createShader(t,e,n.default.VERTEX_SHADER)),n.default.attachShader(r,this.createShader(t,e,n.default.FRAGMENT_SHADER)),n.default.linkProgram(r),!n.default.getProgramParameter(r,n.default.LINK_STATUS))throw n.default.deleteProgram(r),new Error(`Couldn't link shader program: ${n.default.getProgramInfoLog(r)}`);return r}),this.createShader=((t,e,r)=>{const s=this.createDefineKeys(t,e,r),i=n.default.createShader(r);if(n.default.shaderSource(i,s),n.default.compileShader(i),!n.default.getShaderParameter(i,n.default.COMPILE_STATUS))throw n.default.deleteShader(i),new Error(`Failed to compile shader: ${n.default.getShaderInfoLog(i)}`);return i}),this.createDefineKeys=((t,e,r)=>{let s="#version 300 es\n";if(!r)throw new Error(`Type of shader is invalid: ${r}`);return s+=r===n.default.VERTEX_SHADER?"#define VERTEX\n":"#define FRAGMENT\n",e.forEach((t,e)=>{s+=`#define ${e} ${t?` = ${t}\n`:"\n"}`}),`${s}#line 1\n${t}`}),this.getAttributeLocations=(t=>{const e={},r=n.default.getProgramParameter(t,n.default.ACTIVE_ATTRIBUTES);for(let s=0;s<r;s+=1){const r=n.default.getActiveAttrib(t,s).name;e[r]=n.default.getAttribLocation(t,r)}return e}),this.getUniformLocations=(t=>{const e={},r=n.default.getProgramParameter(t,n.default.ACTIVE_UNIFORMS);for(let s=0;s<r;s+=1){const r=n.default.getActiveUniform(t,s).name;e[r]=n.default.getUniformLocation(t,r)}return e})}}]);